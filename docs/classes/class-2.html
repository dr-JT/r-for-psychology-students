<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>R for the Psychology Student ‚Äì Import, Merge, and Restructure Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../classes/class-3.html" rel="next">
<link href="../classes/class-1.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../classes/class-1.html">Classes</a></li><li class="breadcrumb-item"><a href="../classes/class-2.html">Class 2: Import, Merge, Restructure</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">R for the Psychology Student</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Course Prep</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../what-is-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">What is R?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../prerequisites.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prerequisites</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Classes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classes/class-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 1: An Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classes/class-2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Class 2: Import, Merge, Restructure</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classes/class-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 3: Data Transformation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classes/class-4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 4: Reproducible Projects</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classes/class-5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 5: Data Preparation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classes/class-6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 6: Data Scoring</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classes/class-7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 7: Quarto Documents</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classes/class-8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 8: Data Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classes/class-9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 9: ANOVA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classes/class-10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 10: Regression</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Supplemental</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/tips-tricks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tips &amp; Tricks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/pipe-operator.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pipe Operator</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/github_copilot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GitHub Copilot</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/data-prep-qualtrics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Prep - Qualtrics</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#prepare" id="toc-prepare" class="nav-link active" data-scroll-target="#prepare">Prepare</a></li>
  <li><a href="#import" id="toc-import" class="nav-link" data-scroll-target="#import">Import</a>
  <ul class="collapse">
  <li><a href="#rstudio-gui" id="toc-rstudio-gui" class="nav-link" data-scroll-target="#rstudio-gui">RStudio GUI</a></li>
  <li><a href="#csv-files" id="toc-csv-files" class="nav-link" data-scroll-target="#csv-files">CSV Files</a></li>
  <li><a href="#tab-delimited-files" id="toc-tab-delimited-files" class="nav-link" data-scroll-target="#tab-delimited-files">Tab-Delimited Files</a></li>
  </ul></li>
  <li><a href="#merge" id="toc-merge" class="nav-link" data-scroll-target="#merge">Merge</a>
  <ul class="collapse">
  <li><a href="#bind" id="toc-bind" class="nav-link" data-scroll-target="#bind">Bind</a></li>
  <li><a href="#join" id="toc-join" class="nav-link" data-scroll-target="#join">Join</a></li>
  </ul></li>
  <li><a href="#restructure" id="toc-restructure" class="nav-link" data-scroll-target="#restructure">Restructure</a>
  <ul class="collapse">
  <li><a href="#pivot-wider" id="toc-pivot-wider" class="nav-link" data-scroll-target="#pivot-wider">Pivot Wider</a></li>
  <li><a href="#pivot-longer" id="toc-pivot-longer" class="nav-link" data-scroll-target="#pivot-longer">Pivot Longer</a></li>
  </ul></li>
  <li><a href="#learning-activity" id="toc-learning-activity" class="nav-link" data-scroll-target="#learning-activity">Learning Activity</a>
  <ul class="collapse">
  <li><a href="#setup-and-import" id="toc-setup-and-import" class="nav-link" data-scroll-target="#setup-and-import">Setup and Import</a></li>
  <li><a href="#restructure-1" id="toc-restructure-1" class="nav-link" data-scroll-target="#restructure-1">Restructure</a></li>
  <li><a href="#merge-1" id="toc-merge-1" class="nav-link" data-scroll-target="#merge-1">Merge</a></li>
  <li><a href="#plot" id="toc-plot" class="nav-link" data-scroll-target="#plot">Plot</a></li>
  <li><a href="#organize-and-clean-up" id="toc-organize-and-clean-up" class="nav-link" data-scroll-target="#organize-and-clean-up">Organize and Clean Up</a></li>
  <li><a href="#check-your-work" id="toc-check-your-work" class="nav-link" data-scroll-target="#check-your-work">Check Your Work</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../classes/class-1.html">Classes</a></li><li class="breadcrumb-item"><a href="../classes/class-2.html">Class 2: Import, Merge, Restructure</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Import, Merge, and Restructure Data</h1>
<p class="subtitle lead">Class 2</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>The main objective of this class is to get a basic handling on importing data, merging multiple data frames, and restructuring data frames between wide and long formats.</p>
<p>üñ•Ô∏è <a href="../slides/slides-class-2.html" target="_blank">Slides</a></p>
<section id="prepare" class="level1">
<h1>Prepare</h1>
<p>Before starting this class:</p>
<p>üìñ Read about the <a href="../supplemental/pipe-operator.html">Pipe Operator</a></p>
<p>üì¶ Install <code>readr</code>, <code>dplyr</code>, <code>tidyr</code>, <code>ggplot2</code> , <code>Hmisc</code> , <code>RColorBrewer</code></p>
<hr>
</section>
<section id="import" class="level1">
<h1>Import</h1>
<p>R needs to know the full file path to the file on your computer in order to import it - this is what is referred to as an <strong>absolute</strong> file path. Absolute file paths start at the root directory of your computer and might look something like:</p>
<blockquote class="blockquote">
<p><strong>On Macs</strong>:</p>
<p>Users/username/projects/project_name/a_file.csv</p>
<p><strong>On Windows</strong>:</p>
<p>C:\username\projects\project_name\a_file.csv</p>
</blockquote>
<p>What if you don‚Äôt know the full <strong>absolute</strong> file path to your data?</p>
<p>I want to point out three approaches to specifying file paths in R:</p>
<ol type="1">
<li>Use <code>setwd()</code></li>
<li>Use the RStudio Import Dataset GUI</li>
<li>Use RProjects and <code>here()</code></li>
</ol>
<p>Never‚Ä¶ ever‚Ä¶ ever‚Ä¶ use option 1, <code>setwd()</code>.</p>
<p>Instead, you should use RProjects and <code>here()</code>. But we will not cover this until Class 5. For now, we can just use the RStudio Import Dataset GUI to find the <strong>absolute</strong> file path.</p>
<section id="rstudio-gui" class="level2">
<h2 class="anchored" data-anchor-id="rstudio-gui">RStudio GUI</h2>
<p>When you are having difficulty importing a file correctly or unsure of the file format the RStudio Import Dataset GUI can be really useful.</p>
<p>In the <strong>Environment</strong> window click on <strong>‚ÄúImport Dataset‚Äù</strong>. You will see several options available, these options all rely on different packages. For now, select the <strong>From Text (readr)‚Ä¶</strong> option.</p>
<p>You will see a data import window open up that looks like this</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/rstudioGUI-readr.png" class="img-fluid figure-img"></p>
<figcaption>RStudio Import Dataset GUI</figcaption>
</figure>
</div>
<ul>
<li><p>Select <strong>Browse</strong> on the top right and select the data file you want to import.</p></li>
<li><p>The <strong>Data Preview</strong> window will let you see if it is importing it in the right format. You can change the <strong>Import Options</strong> below.</p></li>
<li><p>Click on the üìã icon above the <strong>Code Preview</strong> window to copy the code.</p></li>
<li><p>Click on <strong>Cancel</strong> to exit out of the Import GUI window</p></li>
<li><p>Paste the code into your <strong>Untitled.R</strong> script</p>
<ul>
<li>The most useful thing here will be the <strong>absolute</strong> file path.</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exploring Your Data
</div>
</div>
<div class="callout-body-container callout-body">
<p>When you want to just explore some data and don‚Äôt care about creating a reproducible script it can be perfectly acceptable to not copy and paste the code from <strong>Code Preview</strong> window and just select the <strong>Import</strong> button.</p>
</div>
</div>
</section>
<section id="csv-files" class="level2">
<h2 class="anchored" data-anchor-id="csv-files">CSV Files</h2>
<p><code>csv</code> files are by far the easiest files to import into R and most software programs. For this reason, I suggest any time you want to save/output a data file to your computer, do it in <code>csv</code> format.</p>
<p>CSV stands for ‚ÄúComma-Separated Values.‚Äù It‚Äôs a simple file format used to store data in a table. Each line in the file is a row of the table, and commas are used to separate columns. Think of it like a spreadsheet where each piece of information is lined up in rows and columns, but instead of seeing the grid like in Excel, each row is just a line of text with commas between the values that would go into different columns.</p>
<p><code>csv</code> files are typically saved with <strong>.csv</strong> file extension (e.g., data file.csv)</p>
<p>To import a <code>csv</code> file you can use <code>read_csv()</code> from the <code>readr</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>data_import <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"filepath/datafile.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tab-delimited-files" class="level2">
<h2 class="anchored" data-anchor-id="tab-delimited-files">Tab-Delimited Files</h2>
<p><code>tab-delimited</code> files are a little more tedious to import just because they require specifying more arguments. Which means you have to memorize more to import <code>tab-delimited</code> files.</p>
<p>Tab-delimited files use <strong>tabs</strong> between items in a row to separate columns. In general, the delimiter is the type of value that is used between items in a row to separate columns. There are a lot of different types of delimiters with tab and comma (csv) being the most common.</p>
<p>Tab-delimited files are typically saved with the more standard <strong>.txt</strong> file extension (e.g., data file.txt) but a lot of other file formats might also have the <strong>.txt</strong> extension. This can create some ambiguity as to how the data is stored and formatted for .txt files.</p>
<p>To import a <code>tab-delimited</code> file you can use <code>read_delim()</code> from the <code>readr</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data_import <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">"filepath/datafile.txt"</span>, <span class="at">delim =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">escape_double =</span> <span class="cn">FALSE</span>, <span class="at">trim_ws =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are three additional arguments we have to specify: <code>delim</code>, <code>escape_double</code>, and <code>trim_ws</code>. The notation for <code>tab-delimted</code> files is <code>"\t"</code>. I always forget how to specify each of these arguments so I frequently use the RStudio Import Dataset GUI to copy the code needed to import a tab-delimited file.</p>
</section>
</section>
<section id="merge" class="level1">
<h1>Merge</h1>
<p>You might find yourself in a situation where you need to import multiple data files and merge them into a single data frame. There are two general classes of merging data</p>
<ul>
<li><p>Bind</p></li>
<li><p>Join</p></li>
</ul>
<section id="bind" class="level2">
<h2 class="anchored" data-anchor-id="bind">Bind</h2>
<p>In R, a ‚Äúbind‚Äù is combining data frames together by stacking either the rows or columns.</p>
<p>A row ‚Äúbind‚Äù takes data frames that have the same columns but different rows and stacks them on top of each other. This will happen if you have separate data files for each subject from the same task. Each subject data file will have their unique rows but all subjects will have the same columns.</p>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="images/row_bind.png" class="img-fluid figure-img" width="677"></p>
<figcaption>Illustration of a row bind</figcaption>
</figure>
</div>
<p>A column ‚Äúbind‚Äù takes data frames that have the same rows but different columns and stacks them side-by-side. This is a much less common situation than a row bind and can usually be accomplished with a <strong>join</strong> instead.</p>
<p>Row and column binds can be performed with <code>bind_rows()</code> and <code>bind_cols()</code> from the <code>dplyr</code> package</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>data_merged <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(data_1, data_2)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>data_merged <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(data_1, data_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="join" class="level2">
<h2 class="anchored" data-anchor-id="join">Join</h2>
<p>In R, a ‚Äújoin‚Äù is merging data frames together that have at least one column in common with a mix of shared and unique entries in that column (e.g.&nbsp;Subject IDs).</p>
<p>There are lots of different kinds of joins, some of which are:</p>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="images/dplyr-joins.png" class="img-fluid figure-img" width="405"></p>
<figcaption>Types of joins using dplyr</figcaption>
</figure>
</div>
<p>For a full list and detailed description of the <code>_join()</code> functions see the <a href="https://dplyr.tidyverse.org/reference/index.html#data-frames" target="_blank">dplyr documentation</a></p>
<p>But for the most part you can get away with just knowing how to do a full join using <code>full_join()</code> from the <code>dplyr</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>data_merged <span class="ot">&lt;-</span> <span class="fu">full_join</span>(data_1, data_2, <span class="at">by =</span> <span class="st">"Subject"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Whenever joining, you need to specify what are the <strong>key</strong> column(s) to join by - columns that are common between the data frames. Often times there is more than one <strong>key</strong> column that the data frames need to be joined by:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>data_merged <span class="ot">&lt;-</span> <span class="fu">full_join</span>(data_1, data_2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Subject"</span>, <span class="st">"Session"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="restructure" class="level1">
<h1>Restructure</h1>
<p>The exact same data can be structured in different ways. There are two main formats that any data set can be structured as:</p>
<p><strong>Wide</strong>: Variables are spread out across columns, making the data frame wider</p>
<table class="table">
<colgroup>
<col style="width: 24%">
<col style="width: 27%">
<col style="width: 24%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Participant ID</strong></th>
<th><strong>Stress Level Score</strong></th>
<th><strong>Creativity Score</strong></th>
<th><strong>Memory Score</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>5</td>
<td>7</td>
<td>8</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>6</td>
<td>7</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>8</td>
<td>6</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><strong>Long</strong>: Variables and values are spread across rows, making the data frame longer</p>
<table class="table">
<thead>
<tr class="header">
<th><strong>Participant ID</strong></th>
<th><strong>Test Type</strong></th>
<th><strong>Score</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Stress Level</td>
<td>5</td>
</tr>
<tr class="even">
<td>1</td>
<td>Creativity</td>
<td>7</td>
</tr>
<tr class="odd">
<td>1</td>
<td>Memory</td>
<td>8</td>
</tr>
<tr class="even">
<td>2</td>
<td>Stress Level</td>
<td>3</td>
</tr>
<tr class="odd">
<td>2</td>
<td>Creativity</td>
<td>6</td>
</tr>
<tr class="even">
<td>2</td>
<td>Memory</td>
<td>7</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Stress Level</td>
<td>4</td>
</tr>
<tr class="even">
<td>3</td>
<td>Creativity</td>
<td>8</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Memory</td>
<td>6</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>And actually, you can have a <strong>mix of wide and long</strong> formatted data in a single data frame.</p>
<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Participant ID</strong></th>
<th><strong>Session</strong></th>
<th><strong>Stress Level</strong></th>
<th><strong>Creativity</strong></th>
<th><strong>Memory</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>5</td>
<td>7</td>
<td>8</td>
</tr>
<tr class="even">
<td>1</td>
<td>2</td>
<td>4</td>
<td>8</td>
<td>9</td>
</tr>
<tr class="odd">
<td>1</td>
<td>3</td>
<td>3</td>
<td>9</td>
<td>10</td>
</tr>
<tr class="even">
<td>2</td>
<td>1</td>
<td>6</td>
<td>6</td>
<td>7</td>
</tr>
<tr class="odd">
<td>2</td>
<td>2</td>
<td>5</td>
<td>7</td>
<td>8</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>4</td>
<td>8</td>
<td>9</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1</td>
<td>4</td>
<td>8</td>
<td>6</td>
</tr>
<tr class="even">
<td>3</td>
<td>2</td>
<td>3</td>
<td>9</td>
<td>7</td>
</tr>
<tr class="odd">
<td>3</td>
<td>3</td>
<td>2</td>
<td>10</td>
<td>8</td>
</tr>
</tbody>
</table>
<p>Session is in long format with values stacked in rows. Stress, creativity, and memory are all in wide format.</p>
<p>A good rule of thumb for formatting data is to <strong>have your variables (IVs and DVs) each have their own column</strong>.</p>
<ul>
<li><p>Notice that this is not the case in the <strong>long</strong> formatted data above. <code>Test Type</code> and <code>Score</code> are not variables in this study. Rather <code>Stress</code>, <code>Creativity</code>, and <code>Memory</code> are. Therefore, it makes more sense to have that data in a <strong>wide</strong> format.</p></li>
<li><p>This often results in:</p>
<ul>
<li><p>Measured variables in wide format</p></li>
<li><p>Experimental conditions or repeated-measures in long format</p></li>
</ul></li>
<li><p>Notice how <code>Session</code>, a within-subject variable, is in long format because <code>Session</code> is an independent variable in the study, so <code>Session</code> needs it‚Äôs own column. <code>Stress</code>, <code>Creativity</code>, and <code>Memory</code> are other variables (probably dependent variables) in this study and so they need their own columns, therefore they are laid out in a wide format.</p></li>
</ul>
<p>Restructuring data involves changing the structure from long-to-wide (wider) or wide-to-long (longer). The <code>tidyr</code> package provides useful functions to do this:</p>
<ul>
<li><p><code>pivot_wider()</code> ‚Äúwidens‚Äù data from long-to-wide</p></li>
<li><p><code>pivot_longer()</code> ‚Äúlengthens‚Äù data from wide-to-long</p></li>
</ul>
<p>The <code>tidyr</code> package, like <code>readr</code> and <code>dplyr</code>, is from the <strong>tidyverse</strong> set of packages.</p>
<section id="pivot-wider" class="level2">
<h2 class="anchored" data-anchor-id="pivot-wider">Pivot Wider</h2>
<p>Using the example data sets above, let‚Äôs restructure the long data frame to a wide format:</p>
<p>First let‚Äôs create the data frame - you can just copy and paste this code</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>data_long <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ParticipantID =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">each =</span> <span class="dv">3</span>),</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">TestType =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Stress Level"</span>, <span class="st">"Creativity"</span>, <span class="st">"Memory"</span>), <span class="at">times =</span> <span class="dv">3</span>),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Score =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">6</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The two main arguments to specify in <code>pivot_wider()</code> are</p>
<ul>
<li><p><strong>names_from</strong>: The column name that contains the variables to create new columns by (e.g.&nbsp;‚ÄúTest Type‚Äù). The values in this column will become Column names in the wider data format.</p></li>
<li><p><strong>values_from</strong>: The column name that contains the values (e.g.&nbsp;‚ÄúScore‚Äù).</p></li>
</ul>
<p>Now we can use <code>pivot_wider()</code> to convert it to a wide format:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>data_wide <span class="ot">&lt;-</span> data_long <span class="sc">|&gt;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> TestType,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> Score)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Column Names
</div>
</div>
<div class="callout-body-container callout-body">
<p>R does not like column names to have spaces in them, but it does allow it.</p>
<p>Notice how in <code>data_wide</code> the column <code>Stress Level</code> contains a space. This is because the value in <code>data_long</code> had a space, which was not a problem then.</p>
<p><code>clean_names()</code> from the <code>janitor</code> package provides a convenient way to get rid of spaces and replace them with an <code>_</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>data_wide_clean <span class="ot">&lt;-</span> <span class="fu">clean_names</span>(data_wide, <span class="at">case =</span> <span class="st">"parse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="pivot-longer" class="level2">
<h2 class="anchored" data-anchor-id="pivot-longer">Pivot Longer</h2>
<p>The three main arguments to specify in <code>pivot_longer()</code> are:</p>
<ul>
<li><p><strong>cols</strong>: The column names that will be restructured to a longer format</p></li>
<li><p><strong>names_to</strong>: The new column name that will contain values which correspond to the column names in the wide data</p></li>
<li><p><strong>values_to</strong>: The new column name that will contain the actual values in the wide data</p></li>
</ul>
<p>Using <code>pivot_longer()</code> we can restructure the data back to long format</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>data_long_again <span class="ot">&lt;-</span> data_wide <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">any_of</span>(<span class="fu">c</span>(<span class="st">"Stress Level"</span>, <span class="st">"Creativity"</span>, <span class="st">"Memory"</span>)),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"TestType"</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Score"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Check to make sure <code>data_long</code> and <code>data_long_again</code> are identical.</p>
<p>Okay, now let‚Äôs say we have a wide data set with multiple sessions of <code>Stress</code> , <code>Creativity</code>, and <code>Memory</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>data_sessions_wide <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ParticipantID =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">StressLevel_S1 =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">4</span>),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Creativity_S1 =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">8</span>),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Memory_S1 =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">6</span>),</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">StressLevel_S2 =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">3</span>),</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Creativity_S2 =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">9</span>),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Memory_S2 =</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">7</span>),</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">StressLevel_S3 =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">2</span>),</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Creativity_S3 =</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">10</span>),</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Memory_S3 =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">9</span>, <span class="dv">8</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The data is not very useful in this format, so let‚Äôs restructure it to be a mix of long and wide format. Using the rule of thumb above, we want to create 4 columns with <code>Session</code>, <code>Stress Level</code>, <code>Creativity</code>, and <code>Memory</code>. There are two strategies for doing this:</p>
<ol type="1">
<li>Using <code>pivot_longer()</code>, <code>separate()</code>, and then <code>pivot_wider()</code></li>
<li>Use more complicated syntax in <code>pivot_longer()</code></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Using pivot_longer(), separate(), and then pivot_wider()</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>data_sessions_1 <span class="ot">&lt;-</span> data_sessions_wide <span class="sc">|&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"_S"</span>),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Session"</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Score"</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(Session, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"Test"</span>, <span class="st">"Session"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Test,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> Score)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Use more complicated syntax in pivot_longer()</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>data_sessions_2 <span class="ot">&lt;-</span> data_sessions_wide <span class="sc">|&gt;</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"_S"</span>),</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">".value"</span>, <span class="st">"Session"</span>),</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_pattern =</span> <span class="st">"(.*)_(S</span><span class="sc">\\</span><span class="st">d)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You may find yourself in a situation where you need to select multiple columns in a argument but it can be tedious to type each every column, especially if the number of columns is larger.</p>
<p>There are what is known as tidy select functions to easily select column names, particularly if there is a consistent pattern to those column names.</p>
<p>This can be very useful in functions like <code>pivot_longer()</code>. In the examples provided on above, we used some tidy select functions: <code>any_of()</code> and <code>contains()</code>.</p>
<p>To learn more about what tidy select functions are available and what they do read the <a href="https://dplyr.tidyverse.org/reference/dplyr_tidy_select.html" target="_blank">tidy select documentation</a>.</p>
<hr>
</section>
</section>
<section id="learning-activity" class="level1">
<h1>Learning Activity</h1>
<p>Let‚Äôs consider a hypothetical study investigating the impact of sleep quality interventions on cognitive performance and mood across several weeks. In this scenario, participants are exposed to two interventions (Sleep Hygiene Education and Relaxation Techniques) and their cognitive performance scores and mood ratings are recorded weekly.</p>
<p>You‚Äôre analyzing data from a hypothetical psychology experiment where participant‚Äôs cognitive performance scores and mood ratings are recorded across four weeks for two interventions. The data is split into two files, one with the cognitive performance data (class_2_cog_data.csv) and another with the mood ratings data (class_2_mood_data.txt), but the same participants across each data set.</p>
<p>Your task will be to import, restructure, and merge the data so that we can graphically visualize the results of the experiment.</p>
<section id="setup-and-import" class="level2">
<h2 class="anchored" data-anchor-id="setup-and-import">Setup and Import</h2>
<ol type="1">
<li><p>Download the data files:</p>
<p>‚¨áÔ∏è <a href="../data/class_2_cog_data.csv" download="class_2_cog_data.csv">class_2_cog_data.csv</a></p>
<p>‚¨áÔ∏è <a href="../data/class_2_mood_data.txt" download="class_2_mood_data.txt">class_2_mood_data.txt</a></p></li>
<li><p>Create a new R script and save it as <strong>class2_activity.R</strong></p></li>
<li><p>Load the following packages at the top of your script</p>
<ul>
<li><code>readr</code>, <code>dplyr</code>, <code>tidyr</code>, <code>ggplot2</code></li>
</ul></li>
<li><p>Import the data files</p></li>
<li><p>Get to know the data (use what you learned from <a href="../classes/class-1.html">Class</a><a href="../lectures/lectures-class-1.html">1</a>)</p>
<ul>
<li><p>What are the column names?</p></li>
<li><p>What type of values are in the columns?</p></li>
<li><p>How many participants are in the study?</p></li>
<li><p>How many are in each of the intervention conditions?</p></li>
<li><p>Approximately, what are the range of values on cognitive performance and mood ratings?</p>
<ul>
<li>Hint: You can click on the columns names when viewing the data frame to toggle between sorting from low-to-high and high-to-low</li>
</ul></li>
<li><p>Are there are any missing values in the data?</p></li>
</ul></li>
</ol>
</section>
<section id="restructure-1" class="level2">
<h2 class="anchored" data-anchor-id="restructure-1">Restructure</h2>
<ol start="5" type="1">
<li><p>Restructure each data set to long format with <code>week</code> spread across rows instead of columns and one column for <code>cognitive score</code> or <code>mood rating</code></p>
<p>The data frames should look something like</p>
<table class="table">
<colgroup>
<col style="width: 27%">
<col style="width: 31%">
<col style="width: 13%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th><strong>participant_id</strong></th>
<th><strong>intervention_type</strong></th>
<th><strong>week</strong></th>
<th><strong>cognitive_score</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Sleep Hygiene</td>
<td>1</td>
<td>76.09</td>
</tr>
<tr class="even">
<td>1</td>
<td>Sleep Hygiene</td>
<td>2</td>
<td>75.34</td>
</tr>
<tr class="odd">
<td>1</td>
<td>Sleep Hygiene</td>
<td>3</td>
<td>75.09</td>
</tr>
<tr class="even">
<td>1</td>
<td>Sleep Hygiene</td>
<td>4</td>
<td>78.85</td>
</tr>
<tr class="odd">
<td>2</td>
<td>Sleep Hygiene</td>
<td>1</td>
<td>72.30</td>
</tr>
</tbody>
</table>
<table class="table">
<colgroup>
<col style="width: 28%">
<col style="width: 33%">
<col style="width: 14%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th><strong>participant_id</strong></th>
<th><strong>intervention_type</strong></th>
<th><strong>week</strong></th>
<th><strong>mood_score</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Sleep Hygiene</td>
<td>1</td>
<td>66.32</td>
</tr>
<tr class="even">
<td>1</td>
<td>Sleep Hygiene</td>
<td>2</td>
<td>83.44</td>
</tr>
<tr class="odd">
<td>1</td>
<td>Sleep Hygiene</td>
<td>3</td>
<td>76.29</td>
</tr>
<tr class="even">
<td>1</td>
<td>Sleep Hygiene</td>
<td>4</td>
<td>79.14</td>
</tr>
<tr class="odd">
<td>2</td>
<td>Sleep Hygiene</td>
<td>1</td>
<td>60.17</td>
</tr>
</tbody>
</table>
<ul>
<li><p>After you have restructured the data frames, you will notice that the values in the <code>week</code> column also contain the string: <code>cognitive_week_</code> or <code>mood_week_</code>. This is redundant information with the column names and can be removed to clean up the format of the data. The following line of code can be used to to do so.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">week =</span> <span class="fu">parse_number</span>(week))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># e.g., you can pipe the result of pivot_longer() to this mutate() code</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>data_long <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>() <span class="sc">|&gt;</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">week =</span> <span class="fu">parse_number</span>(week))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
</ul></li>
</ol>
</section>
<section id="merge-1" class="level2">
<h2 class="anchored" data-anchor-id="merge-1">Merge</h2>
<ol start="6" type="1">
<li><p>Merge the two long data frames into one data frame.</p>
<ul>
<li>Hint: There is more than one <strong>key</strong> column that the data frames need to be joined by.</li>
</ul></li>
</ol>
</section>
<section id="plot" class="level2">
<h2 class="anchored" data-anchor-id="plot">Plot</h2>
<ol start="7" type="1">
<li><p>Plot the cognitive performance data:</p>
<p>Create a plot showing the cognitive scores (y-axis) across weeks (x-axis) by intervention type (color). Something like this:</p>
<p><img src="images/class_2_cognitive_plot.png" class="img-fluid" width="413"></p>
<ol type="a">
<li><p>First add the data and aesthetic layers - how the data map onto the plot scales and axes</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>data should be changed to the name of your data frame containing the cognitive data</p></li>
<li><p>var_x should be changed to the name of the column that should be plotted on the x-axis</p></li>
<li><p>var_y should be changed to the name of the column that should be plotted on the y-axis</p></li>
<li><p>var_color should be change to the name of the column containing the intervention type</p></li>
</ul>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># change the following values to fit your data</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># data, var_x, var_y, var_color</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> var_x, <span class="at">y =</span> var_y,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> var_color, <span class="at">group =</span> var_color))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>Now let‚Äôs add in the geometries layer - the visual elements used for the data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> var_x, <span class="at">y =</span> var_y,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> var_color, <span class="at">group =</span> var_color))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width =</span> .<span class="dv">9</span>) <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">size =</span> <span class="fl">1.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>No need to modify the code here. For now don‚Äôt worry about what these are doing, we will cover graphical visualization in more detail in later chapters. But you can see that we are plotting three <code>geom</code> layers, <strong>errorbar</strong>, <strong>line</strong>, and <strong>point</strong>. We need to use <code>stat_summary()</code> because the data are not aggregated, this function will aggregate the data across participants using <code>fun = mean</code>.</p></li>
<li><p>Finally, let‚Äôs make this plot a little prettier</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># change the following values based on your preference</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the width, and size values in stat_summary()</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># lower limit and upper limit in coord_cartesian()</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># the title, x, y, and color in labs()</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># choose a ggplot2 theme</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> var_x, <span class="at">y =</span> var_y,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> var_color, <span class="at">group =</span> var_color)) <span class="sc">+</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width =</span> .<span class="dv">9</span>) <span class="sc">+</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">72</span>, <span class="dv">80</span>)) <span class="sc">+</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Give the plot a title"</span>, </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"change x-axis label"</span>, </span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"change y-axis label"</span>, </span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"change legend title"</span>) <span class="sc">+</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_</span>() <span class="co"># choose a ggplot2 theme</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Change the following values based on your preference</p>
<ul>
<li><p>the width of the error bars: <code>stat_summary(width = .9)</code></p></li>
<li><p>the size of the lines: <code>stat_summary(size = .5)</code></p></li>
<li><p>the size of the data points: <code>stat_summary(size = .1.5)</code></p></li>
<li><p>the lower and upper limit of the y-axis (zoom in or out): <code>coord_cartesian(ylim = c(lower_limit, upper_limit)</code></p></li>
<li><p>add a plot title</p></li>
<li><p>the y-axis, x-axis, and legend labels. e.g., no underscores, capitalize words, etc.</p></li>
<li><p>choose a brewer color palette: <code>scale_color_brewer(palette = "Set1")</code></p>
<ul>
<li>See options here: <a href="https://r-graph-gallery.com/38-rcolorbrewers-palettes.html" target="_blank">R Color Brewer‚Äôs palettes</a></li>
</ul></li>
<li><p>choose a <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" target="_blank">ggplot2 theme</a>:</p>
<ul>
<li><p><code>theme_bw()</code></p></li>
<li><p><code>theme_light()</code></p></li>
<li><p><code>theme_dark()</code></p></li>
<li><p><code>theme_minimal()</code></p></li>
<li><p><code>theme_classic()</code></p></li>
<li><p><code>theme_void()</code></p></li>
</ul></li>
</ul></li>
</ol></li>
<li><p>Plot the mood data:</p>
<p><img src="images/class_2_mood_plot.png" class="img-fluid" width="412"></p>
<ul>
<li><p>Copy and paste the code you wrote for plotting the cognitive performance data.</p></li>
<li><p>Change values as needed</p>
<ul>
<li><p>The variable to be plotted on the y-axis <code>aes(y = )</code></p></li>
<li><p>the lower and upper limits of the y-axis <code>coord_cartesian(ylim = c(lower_limit, upper_limit)</code></p></li>
<li><p>plot title, y-axis, x-axis, and legend labels</p></li>
</ul></li>
</ul></li>
<li><p>Save the plots as a file on your computer</p>
<ul>
<li><p>Place the following code directly below the code for creating each of the plots. It will save the last generated plot to a file. Change the file name for each plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"folder/path/class_2_cognitive_plot.png"</span>, </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
</ul></li>
</ol>
</section>
<section id="organize-and-clean-up" class="level2">
<h2 class="anchored" data-anchor-id="organize-and-clean-up">Organize and Clean Up</h2>
<ol start="10" type="1">
<li><p>Organize and clean up your script</p>
<ul>
<li>Load all packages at the top of your script</li>
<li>Get rid of code that is not necessary, such as:
<ul>
<li><code>install.package()</code> calls</li>
<li><code>View()</code></li>
</ul></li>
<li>Add comment headers to sections of your code: e.g., <code># load packages</code></li>
</ul></li>
</ol>
</section>
<section id="check-your-work" class="level2">
<h2 class="anchored" data-anchor-id="check-your-work">Check Your Work</h2>
<p><strong>You should attempt to complete the activity without looking at this code</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb17" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># import data</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>cog_import <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/class_2_cog_data.csv"</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>mood_import <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">"data/class_2_mood_data.txt"</span>, </span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">delim =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">escape_double =</span> <span class="cn">FALSE</span>, <span class="at">trim_ws =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co"># restructure data</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>cog_data <span class="ot">&lt;-</span> cog_import <span class="sc">|&gt;</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"cognitive_week"</span>), </span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"week"</span>, </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"cognitive_score"</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">week =</span> <span class="fu">parse_number</span>(week))</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>mood_data <span class="ot">&lt;-</span> mood_import <span class="sc">|&gt;</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"mood_week"</span>), </span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"week"</span>, </span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"mood_score"</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">week =</span> <span class="fu">parse_number</span>(week))</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="co"># merge data</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>data_merged <span class="ot">&lt;-</span> <span class="fu">full_join</span>(cog_data, mood_data, </span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>                         <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"participant_id"</span>, <span class="st">"intervention_type"</span>, <span class="st">"week"</span>))</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="co"># plot data</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_merged, <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> cognitive_score, </span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color =</span> intervention_type, <span class="at">group =</span> intervention_type)) <span class="sc">+</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">65</span>, <span class="dv">85</span>)) <span class="sc">+</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cognitive Scores Across Weeks by Intervention Type"</span>, </span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Week"</span>, </span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Cognitive Score"</span>, </span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Intervention Type"</span>) <span class="sc">+</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/class_2_cognitive_plot.png"</span>, </span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_merged, <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> mood_score, </span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color =</span> intervention_type, <span class="at">group =</span> intervention_type)) <span class="sc">+</span></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">80</span>)) <span class="sc">+</span></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mood Across Weeks by Intervention Type"</span>, </span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Week"</span>, </span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Mood"</span>, </span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Intervention Type"</span>) <span class="sc">+</span></span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/class_2_mood_plot.png"</span>, </span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/dr-jt\.github\.io\/r-for-psychology-students\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../classes/class-1.html" class="pagination-link" aria-label="Class 1: An Introduction">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Class 1: An Introduction</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../classes/class-3.html" class="pagination-link" aria-label="Class 3: Data Transformation">
        <span class="nav-page-text">Class 3: Data Transformation</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<script src="../site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.js" defer="true"></script>
</body></html>