<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>R for the Psychology Student ‚Äì Class 6: Data Scoring</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">
      R for the Psychology Student
      </li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">R for the Psychology Student</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Course Information</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../what-is-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">What is R?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../prerequisites.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prerequisites</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Classes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classes/class-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classes/class-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classes/class-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classes/class-4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classes/class-5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 5</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classes/class-6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 6</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classes/class-7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 7</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../classes/class-8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class 8</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Supplemental</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/tips-tricks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tips &amp; Tricks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/github_copilot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GitHub Copilot</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/data-prep-qualtrics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Prep - Qualtrics</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#template-r-script" id="toc-template-r-script" class="nav-link active" data-scroll-target="#template-r-script">Template R Script</a></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data">Import Data</a></li>
  <li><a href="#score-data" id="toc-score-data" class="nav-link" data-scroll-target="#score-data">Score Data</a>
  <ul class="collapse">
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning">Data Cleaning</a>
  <ul class="collapse">
  <li><a href="#attention-checks" id="toc-attention-checks" class="nav-link" data-scroll-target="#attention-checks">Attention Checks</a></li>
  <li><a href="#missing-data" id="toc-missing-data" class="nav-link" data-scroll-target="#missing-data">Missing Data</a></li>
  <li><a href="#reaction-times" id="toc-reaction-times" class="nav-link" data-scroll-target="#reaction-times">Reaction Times</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#data-scoring" id="toc-data-scoring" class="nav-link" data-scroll-target="#data-scoring">Data Scoring</a>
  <ul class="collapse">
  <li><a href="#between-subjects-anova" id="toc-between-subjects-anova" class="nav-link" data-scroll-target="#between-subjects-anova">Between-Subjects ANOVA</a></li>
  <li><a href="#within-subjects-anova" id="toc-within-subjects-anova" class="nav-link" data-scroll-target="#within-subjects-anova">Within-Subjects ANOVA</a></li>
  <li><a href="#correlation-and-regression" id="toc-correlation-and-regression" class="nav-link" data-scroll-target="#correlation-and-regression">Correlation and Regression</a></li>
  </ul></li>
  <li><a href="#save-data" id="toc-save-data" class="nav-link" data-scroll-target="#save-data">Save Data</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Class 6: Data Scoring</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>After data preparation, the next stage in the data processing workflow is to score the data.</p>
<p><img src="images/data_steps.png" class="img-fluid"></p>
<p>By score the data, I mean create variables that are an aggregate (summary statistic) across multiple responses. In general, there are multiple types of summary statistics that can be computed. Common ones are:</p>
<ul>
<li><p>Sum: <code>sum()</code></p></li>
<li><p>Mean (average): <code>mean()</code></p></li>
<li><p>Median: <code>median()</code></p></li>
<li><p>Standard deviation: <code>sd()</code></p></li>
</ul>
<p>For questionnaires and surveys, this typically a sum or average is computed on items that belong to the same scale or subscale.</p>
<p>For behavioral and cognitive tasks, summary statistics are aggregated over trials that belong to the same condition.</p>
<p>In this class will focus on general principles and common data scoring steps.</p>
<p>In <a href="../lectures/lectures-class-5.html">Class 5</a> you setup a project with a folder organization and RStudio Project file:</p>
<p>üìÅ analyses</p>
<p>üìÅ data</p>
<p>&nbsp;&nbsp;&nbsp;üìÅ raw</p>
<p>üìÅ R</p>
<p>If you have multiple raw data files to score, you may consider creating a <strong>scored</strong> folder in <strong>data</strong></p>
<p>üìÅ data</p>
<p>&nbsp;&nbsp;&nbsp;üìÅ raw</p>
<p>&nbsp;&nbsp;&nbsp;üìÅ scored</p>
<p>This class assumes you have this project organization setup and a tidy raw data file to work with.</p>
<p>In Class 5, we ended up with a tidy raw data file:</p>
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["ID"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Procedure"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Trial"],"name":[3],"type":["int"],"align":["right"]},{"label":["Condition"],"name":[4],"type":["chr"],"align":["left"]},{"label":["Response"],"name":[5],"type":["chr"],"align":["left"]},{"label":["Correct_Response"],"name":[6],"type":["chr"],"align":["left"]},{"label":["Accuracy"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["RT"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"practice","3":"1","4":"word_mismatch","5":"yes","6":"yes","7":"1","8":"560"},{"1":"1","2":"practice","3":"2","4":"word_mismatch","5":"no","6":"yes","7":"0","8":"670"},{"1":"1","2":"practice","3":"3","4":"word_match","5":"yes","6":"no","7":"0","8":"400"},{"1":"1","2":"real","3":"1","4":"word_mismatch","5":"yes","6":"yes","7":"1","8":"431"},{"1":"1","2":"real","3":"2","4":"word_match","5":"no","6":"no","7":"1","8":"23"},{"1":"1","2":"real","3":"3","4":"word_match","5":"yes","6":"no","7":"0","8":"643"},{"1":"1","2":"real","3":"4","4":"word_mismatch","5":"yes","6":"yes","7":"1","8":"742"},{"1":"1","2":"real","3":"5","4":"word_mismatch","5":"yes","6":"no","7":"0","8":"9452"},{"1":"2","2":"practice","3":"1","4":"word_mismatch","5":"yes","6":"yes","7":"1","8":"332"},{"1":"2","2":"practice","3":"2","4":"word_match","5":"yes","6":"yes","7":"1","8":"434"},{"1":"2","2":"practice","3":"3","4":"word_mismatch","5":"no","6":"no","7":"1","8":"536"},{"1":"2","2":"real","3":"1","4":"word_mismatch","5":"yes","6":"yes","7":"1","8":"455"},{"1":"2","2":"real","3":"2","4":"word_mismatch","5":"yes","6":"no","7":"0","8":"743"},{"1":"2","2":"real","3":"3","4":"word_match","5":"yes","6":"no","7":"0","8":"456"},{"1":"2","2":"real","3":"4","4":"word_mismatch","5":"yes","6":"yes","7":"1","8":"186"},{"1":"2","2":"real","3":"5","4":"word_mismatch","5":"yes","6":"no","7":"0","8":"342"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[20],"max":[20]},"pages":{}}}
  </script>
</div>
</div>
</div>
<section id="template-r-script" class="level1">
<h1>Template R Script</h1>
<p>The main goal at this stage is to complete an R script to create a data file that contains aggregated scores from a tidy raw data file.</p>
<ol type="1">
<li>Create a new R script file named: <strong>2_score.R</strong>
<ul>
<li>If you have multiple tidy raw data files to score, then you should create separate scripts for each one and name the script file with the measure that it comes from (you can keep the 2_ prefix for all of them).</li>
</ul></li>
<li>Save it in the <strong>R</strong> folder</li>
<li>Copy and paste this template into your script: (use the copy icon button on the top-right)</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Setup -------------------------------------------------------------------</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># packages</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># directories</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>import_dir <span class="ot">&lt;-</span> <span class="st">"data/raw"</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>output_dir <span class="ot">&lt;-</span> <span class="st">"data/scored"</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># file names</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>import_file <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>output_file <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Import Data -------------------------------------------------------------</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>data_import <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(import_dir, import_file))</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Score Data --------------------------------------------------------------</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>data_scores <span class="ot">&lt;-</span> data_import <span class="sc">|&gt;</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>() <span class="sc">|&gt;</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">.by =</span> Subject)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Save Data ---------------------------------------------------------------</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(data_scores, <span class="fu">here</span>(output_dir, output_file))</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------------------</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="4" type="1">
<li>Use the 2_score.R script template to get <strong>started</strong>. It is just a template, you will need to modify it for your data specifically. The template contains 4 main sections:
<ul>
<li>Setup</li>
<li>Import Data</li>
<li>Score Data</li>
<li>Save Data</li>
</ul></li>
</ol>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you have multiple tidy raw data files that need to be scored, then you should create a separate <strong>score</strong> script for each one.</p>
<p>However, if you only have one tidy raw data file because your data was all collected in a single task/measure then you can just create one <strong>score</strong> script</p>
</div>
</div>
</section>
<section id="setup" class="level1">
<h1>Setup</h1>
<p>The <strong>Setup</strong> section is to:</p>
<ul>
<li><p>Load any packages used in the script</p></li>
<li><p>Set the directories of where to import and output data files to</p></li>
<li><p>Set the file names of the data files to be imported and outputted</p></li>
</ul>
<p>I like to include the directory and file names at the top of the script that way it is easy to see what is being imported/outputted and from where right at the top of the script rather than having to search through the script for this information.</p>
<p>We can then use the <code>import_dir</code> , <code>output_dir</code>, <code>import_file</code>, and <code>output_file</code> variables in the script when we import and output a data file.</p>
</section>
<section id="import-data" class="level1">
<h1>Import Data</h1>
<p>The <strong>Import Data</strong> section is simply to import the data.</p>
<p>I suggest using the <code>here()</code> package to specify the file path. This was covered in <a href="../lectures/lectures-class-4.html#herehere">Class 4</a>.</p>
<p>Given that 1) you created a tidy raw data file in .csv format, and 2) you specified <code>import_dir</code> and <code>import_file</code> in the setup section, you most likely do not need to change anything here.</p>
</section>
<section id="score-data" class="level1">
<h1>Score Data</h1>
<p>The <strong>Score Data</strong> section is where most of the work needs to be done. You should be using <code>dplyr</code> and possibly <code>tidyr</code> to do most of the work here, though you may need other packages and functions. You can delete whatever is in there now, that is just a placeholder as an example of the type of functions you might use. See the following class materials to help you in this section:</p>
<ul>
<li><p><a href="https://dr-jt.github.io/r-for-psychology-students/classes/class-2.html" target="_blank">Class 2: Importing, Merging, and Restructuring</a></p></li>
<li><p><a href="https://dr-jt.github.io/r-for-psychology-students/classes/class-3.html" data-taget="_blank">Class 3: Data Transformation</a></p></li>
</ul>
<p>How you need to score your data depends on what you are measuring and what type of conditions you have. However, most approaches require calculating a summary statistic at some point. We will cover how to use <code>summarise(.by = )</code> to calculate summary statistics.</p>
<p>With this sample data let‚Äôs calculate a few different scores</p>
<ul>
<li><p>Mean accuracy</p></li>
<li><p>Mean reaction time</p></li>
<li><p>Hit rate</p></li>
<li><p>False alarm rate</p></li>
</ul>
<p>But first, it can be a good idea to do some <strong>data cleaning</strong> before scoring the data to make sure we are using only quality data.</p>
<section id="data-cleaning" class="level2">
<h2 class="anchored" data-anchor-id="data-cleaning">Data Cleaning</h2>
<p>The data cleaning that you need to do will of course depend on the nature of your data and study. Give some thought to the type of data cleaning steps you might want to take. Think about what would identify an observation or participant as having low quality data.</p>
<section id="attention-checks" class="level3">
<h3 class="anchored" data-anchor-id="attention-checks">Attention Checks</h3>
<p>For surveys, researchers will often include ‚Äúattention checks‚Äù just to make sure participants are actually reading the questions and items and not just mindlessly responding. This would likely include removing data for an entire participant. In this scenario, you could:</p>
<ol type="1">
<li>Create a column, <code>attention_check</code> , using <code>mutate()</code> and <code>case_when()</code> that identifies whether an attention check item passed (coded as 0) or failed (coded as 1).</li>
<li>Create another column, <code>attention_check_failures</code> using <code>mutate(.by = ID)</code> (ID is the column containing participant IDs) to calculate a sum of <code>attention_check</code> per each participant.</li>
<li>Come up with a criterion for how many attention checks a participant can fail and use that criterion with <code>filter(attention_check_failures &lt;= criterion)</code></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># you can set this criterion in the setup section of the R script</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># you should come up with your own criterion though, I gave this no thought</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>attention_check_criterion <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># let's say item 4 is an attention check</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># and "agree" is the correct response if they were paying attention</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> import <span class="sc">|&gt;</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.by =</span> ID,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">attention_check =</span> <span class="fu">case_when</span>(Item <span class="sc">==</span> <span class="dv">4</span> <span class="sc">&amp;</span> Response <span class="sc">==</span> <span class="st">"agree"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>                                     Item <span class="sc">==</span> <span class="dv">4</span> <span class="sc">&amp;</span> response <span class="sc">!=</span> <span class="st">"agree"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">.default =</span> <span class="fu">as.numeric</span>(<span class="cn">NA</span>)),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">attention_check_failures =</span> <span class="fu">sum</span>(attention_check, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(attention_check_failures <span class="sc">&lt;=</span> attention_check_criterion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="missing-data" class="level3">
<h3 class="anchored" data-anchor-id="missing-data">Missing Data</h3>
<p>There is a possibility that a participant has missing data. Maybe they did not answer all the questions on a survey. You can use a similar approach as with attention checks.</p>
<ol type="1">
<li>Create a column, <code>missing</code> , using <code>mutate()</code> , <code>case_when()</code> , and <code>is.na()</code> that identifies whether an item has missing data (coded as 1) or not (coded as 0).</li>
<li>Create another column, <code>missing_total</code> using <code>mutate(.by = ID)</code> (ID is the column containing participant IDs) to calculate a sum of <code>missing</code> per each participant.</li>
<li>Come up with a criterion for how many missing items a participant can have and use that criterion with <code>filter(missing_total &lt;= criterion)</code></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># you can set this criterion in the setup section of the R script</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># you should come up with your own criterion though, I gave this no thought</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>missing_criterion <span class="ot">&lt;-</span> .<span class="dv">2</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># let's say item 4 is an attention check</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># and "agree" is the correct response if they were paying attention</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> import <span class="sc">|&gt;</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.by =</span> ID,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">missing =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(Item) <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>                             <span class="sc">!</span><span class="fu">is.na</span>(Item) <span class="sc">~</span> <span class="dv">0</span>),</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">missing_total =</span> <span class="fu">sum</span>(missing, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(missing_total <span class="sc">&lt;=</span> missing_criterion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="reaction-times" class="level3">
<h3 class="anchored" data-anchor-id="reaction-times">Reaction Times</h3>
<p>For behavioral and cognitive tasks that include measures of reaction time, researchers will often exclude trials that have unrealistically fast reaction times or extremely long reaction times.</p>
<p>You will notice that in the tidy raw data file created in Class 5 (see the data frame above), there are a few trials that contain unrealistically fast reaction times and extremely long reaction times.</p>
<p>A common criterion for unrealistically fast reaction times is anything less than 200 milliseconds. For extremely long reaction times, we can just use 5000 milliseconds (5 seconds) as the criterion.</p>
<p>There are two general strategies to do this:</p>
<ul>
<li><p>use <code>filter()</code> to get rid of the rows entirely</p></li>
<li><p>use <code>mutate()</code> and <code>case_when()</code> to set the reaction time and accuracy values to missing <code>NA</code></p></li>
</ul>
<section id="using-filter" class="level4">
<h4 class="anchored" data-anchor-id="using-filter">Using filter</h4>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Data Frame</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb4" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set criterion in setup section of script</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>rt_short_criterion <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>rt_long_criterion <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>data_scores <span class="ot">&lt;-</span> data_import <span class="sc">|&gt;</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(RT <span class="sc">&gt;=</span> rt_short_criterion, RT <span class="sc">&lt;=</span> rt_long_criterion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["ID"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Procedure"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Trial"],"name":[3],"type":["int"],"align":["right"]},{"label":["Condition"],"name":[4],"type":["chr"],"align":["left"]},{"label":["Response"],"name":[5],"type":["chr"],"align":["left"]},{"label":["Correct_Response"],"name":[6],"type":["chr"],"align":["left"]},{"label":["Accuracy"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["RT"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"practice","3":"1","4":"word_mismatch","5":"yes","6":"yes","7":"1","8":"560"},{"1":"1","2":"practice","3":"2","4":"word_mismatch","5":"no","6":"yes","7":"0","8":"670"},{"1":"1","2":"practice","3":"3","4":"word_match","5":"yes","6":"no","7":"0","8":"400"},{"1":"1","2":"real","3":"1","4":"word_mismatch","5":"yes","6":"yes","7":"1","8":"431"},{"1":"1","2":"real","3":"3","4":"word_match","5":"yes","6":"no","7":"0","8":"643"},{"1":"1","2":"real","3":"4","4":"word_mismatch","5":"yes","6":"yes","7":"1","8":"742"},{"1":"2","2":"practice","3":"1","4":"word_mismatch","5":"yes","6":"yes","7":"1","8":"332"},{"1":"2","2":"practice","3":"2","4":"word_match","5":"yes","6":"yes","7":"1","8":"434"},{"1":"2","2":"practice","3":"3","4":"word_mismatch","5":"no","6":"no","7":"1","8":"536"},{"1":"2","2":"real","3":"1","4":"word_mismatch","5":"yes","6":"yes","7":"1","8":"455"},{"1":"2","2":"real","3":"2","4":"word_mismatch","5":"yes","6":"no","7":"0","8":"743"},{"1":"2","2":"real","3":"3","4":"word_match","5":"yes","6":"no","7":"0","8":"456"},{"1":"2","2":"real","3":"5","4":"word_mismatch","5":"yes","6":"no","7":"0","8":"342"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[20],"max":[20]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="set-to-missing" class="level4">
<h4 class="anchored" data-anchor-id="set-to-missing">Set to missing</h4>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Data Frame</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb5" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set criterion in setup section of script</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>rt_short_criterion <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>rt_long_criterion <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>data_scores <span class="ot">&lt;-</span> data_import <span class="sc">|&gt;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RT =</span> <span class="fu">case_when</span>(RT <span class="sc">&lt;</span> rt_short_criterion <span class="sc">~</span> <span class="cn">NA</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                        RT <span class="sc">&gt;</span> rt_long_criterion <span class="sc">~</span> <span class="cn">NA</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">.default =</span> RT),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">Accuracy =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(RT) <span class="sc">~</span> <span class="cn">NA</span>,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                              <span class="at">.default =</span> Accuracy))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["ID"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Procedure"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Trial"],"name":[3],"type":["int"],"align":["right"]},{"label":["Condition"],"name":[4],"type":["chr"],"align":["left"]},{"label":["Response"],"name":[5],"type":["chr"],"align":["left"]},{"label":["Correct_Response"],"name":[6],"type":["chr"],"align":["left"]},{"label":["Accuracy"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["RT"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"practice","3":"1","4":"word_mismatch","5":"yes","6":"yes","7":"1","8":"560"},{"1":"1","2":"practice","3":"2","4":"word_mismatch","5":"no","6":"yes","7":"0","8":"670"},{"1":"1","2":"practice","3":"3","4":"word_match","5":"yes","6":"no","7":"0","8":"400"},{"1":"1","2":"real","3":"1","4":"word_mismatch","5":"yes","6":"yes","7":"1","8":"431"},{"1":"1","2":"real","3":"2","4":"word_match","5":"no","6":"no","7":"NA","8":"NA"},{"1":"1","2":"real","3":"3","4":"word_match","5":"yes","6":"no","7":"0","8":"643"},{"1":"1","2":"real","3":"4","4":"word_mismatch","5":"yes","6":"yes","7":"1","8":"742"},{"1":"1","2":"real","3":"5","4":"word_mismatch","5":"yes","6":"no","7":"NA","8":"NA"},{"1":"2","2":"practice","3":"1","4":"word_mismatch","5":"yes","6":"yes","7":"1","8":"332"},{"1":"2","2":"practice","3":"2","4":"word_match","5":"yes","6":"yes","7":"1","8":"434"},{"1":"2","2":"practice","3":"3","4":"word_mismatch","5":"no","6":"no","7":"1","8":"536"},{"1":"2","2":"real","3":"1","4":"word_mismatch","5":"yes","6":"yes","7":"1","8":"455"},{"1":"2","2":"real","3":"2","4":"word_mismatch","5":"yes","6":"no","7":"0","8":"743"},{"1":"2","2":"real","3":"3","4":"word_match","5":"yes","6":"no","7":"0","8":"456"},{"1":"2","2":"real","3":"4","4":"word_mismatch","5":"yes","6":"yes","7":"NA","8":"NA"},{"1":"2","2":"real","3":"5","4":"word_mismatch","5":"yes","6":"no","7":"0","8":"342"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[20],"max":[20]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="data-scoring" class="level1">
<h1>Data Scoring</h1>
<p>After doing some initial data cleaning (optional), you can then create summary statistics of your measured variables.</p>
<p>The same approach applies here for scale and subscale survey data as with behavioral data.</p>
<p>With this sample data, let‚Äôs start off by calculating:</p>
<ul>
<li><p>Mean reaction time for each participant <code>ID</code> and for each <code>Condition</code></p></li>
<li><p>Mean accuracy for each participant <code>ID</code> and for each <code>Condition</code></p></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Data Frame</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb6" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set criterion in setup section of script</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>rt_short_criterion <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>rt_long_criterion <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>data_scores <span class="ot">&lt;-</span> data_import <span class="sc">|&gt;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RT =</span> <span class="fu">case_when</span>(RT <span class="sc">&lt;</span> rt_short_criterion <span class="sc">~</span> <span class="cn">NA</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>                        RT <span class="sc">&gt;</span> rt_long_criterion <span class="sc">~</span> <span class="cn">NA</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">.default =</span> RT),</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">Accuracy =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(RT) <span class="sc">~</span> <span class="cn">NA</span>,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>                              <span class="at">.default =</span> Accuracy)) <span class="sc">|&gt;</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">.by =</span> <span class="fu">c</span>(ID, Condition),</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">RT_mean =</span> <span class="fu">mean</span>(RT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">Accuracy_mean =</span> <span class="fu">mean</span>(RT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["ID"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Condition"],"name":[2],"type":["chr"],"align":["left"]},{"label":["RT_mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Accuracy_mean"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"word_mismatch","3":"600.75","4":"600.75"},{"1":"1","2":"word_match","3":"521.50","4":"521.50"},{"1":"2","2":"word_mismatch","3":"481.60","4":"481.60"},{"1":"2","2":"word_match","3":"445.00","4":"445.00"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[20],"max":[20]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Now, depending on how this data is going to be analyzed (and even what statistical software you are using to analyze the data) you may want this data frame in either long (its current form) or wide format.</p>
<section id="between-subjects-anova" class="level2">
<h2 class="anchored" data-anchor-id="between-subjects-anova">Between-Subjects ANOVA</h2>
<p><code>Condition</code> is not a between-subject variable in this sample data but if you have a between-subject variable or design, you will want to keep the column(s) for that variable(s) in long format.</p>
</section>
<section id="within-subjects-anova" class="level2">
<h2 class="anchored" data-anchor-id="within-subjects-anova">Within-Subjects ANOVA</h2>
<p><code>Condition</code> is a within-subject variable in this sample data. Whether you want this variable in long or wide format depends on whether you will use R or JASP to analyze the data.</p>
<ul>
<li><p>For R, you can keep it in long format</p></li>
<li><p>For JASP, you will need to restructure it to wide format</p></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Data Frame</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb7" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load tidyr in setup section of script</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set criterion in setup section of script</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>rt_short_criterion <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>rt_long_criterion <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>data_scores <span class="ot">&lt;-</span> data_import <span class="sc">|&gt;</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RT =</span> <span class="fu">case_when</span>(RT <span class="sc">&lt;</span> rt_short_criterion <span class="sc">~</span> <span class="cn">NA</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>                        RT <span class="sc">&gt;</span> rt_long_criterion <span class="sc">~</span> <span class="cn">NA</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">.default =</span> RT),</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">Accuracy =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(RT) <span class="sc">~</span> <span class="cn">NA</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">.default =</span> Accuracy)) <span class="sc">|&gt;</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">.by =</span> <span class="fu">c</span>(ID, Condition),</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">RT_mean =</span> <span class="fu">mean</span>(RT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">Accuracy_mean =</span> <span class="fu">mean</span>(RT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> ID,</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_from =</span> Condition,</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> <span class="fu">c</span>(RT_mean, Accuracy_mean),</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_glue =</span> <span class="st">"{Condition}.{.value}"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p><em>Use the small arrow ‚ñ∏ at the end of the column names to see more columns</em></p>
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["ID"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["word_mismatch.RT_mean"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["word_match.RT_mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["word_mismatch.Accuracy_mean"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["word_match.Accuracy_mean"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"600.75","3":"521.5","4":"600.75","5":"521.5"},{"1":"2","2":"481.60","3":"445.0","4":"481.60","5":"445.0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[20],"max":[20]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="correlation-and-regression" class="level2">
<h2 class="anchored" data-anchor-id="correlation-and-regression">Correlation and Regression</h2>
<p>For correlation and regression you will want to restructure the data to wide format (same as the code above).</p>
<p>If you have multiple data files from different measures or tasks, that you eventually want to merge into a single data frame for analysis, it is a good idea to add the measure or task name to the column names. That way when you merge the data you know which column corresponds to which task.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Data Frame</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb8" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load tidyr in setup section of script</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set criterion in setup section of script</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>rt_short_criterion <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>rt_long_criterion <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>data_scores <span class="ot">&lt;-</span> data_import <span class="sc">|&gt;</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RT =</span> <span class="fu">case_when</span>(RT <span class="sc">&lt;</span> rt_short_criterion <span class="sc">~</span> <span class="cn">NA</span>,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>                        RT <span class="sc">&gt;</span> rt_long_criterion <span class="sc">~</span> <span class="cn">NA</span>,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">.default =</span> RT),</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">Accuracy =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(RT) <span class="sc">~</span> <span class="cn">NA</span>,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">.default =</span> Accuracy)) <span class="sc">|&gt;</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">.by =</span> <span class="fu">c</span>(ID, Condition),</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">RT_mean =</span> <span class="fu">mean</span>(RT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">Accuracy_mean =</span> <span class="fu">mean</span>(RT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> ID,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_from =</span> Condition,</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> <span class="fu">c</span>(RT_mean, Accuracy_mean),</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_glue =</span> <span class="st">"TaskName_{Condition}.{.value}"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p><em>Use the small arrow ‚ñ∏ at the end of the column names to see more columns</em></p>
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["ID"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["TaskName_word_mismatch.RT_mean"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["TaskName_word_match.RT_mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["TaskName_word_mismatch.Accuracy_mean"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["TaskName_word_match.Accuracy_mean"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"600.75","3":"521.5","4":"600.75","5":"521.5"},{"1":"2","2":"481.60","3":"445.0","4":"481.60","5":"445.0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[20],"max":[20]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="save-data" class="level1">
<h1>Save Data</h1>
<p>Finally, you just need to save this scored data frame to a .csv file in your <strong>data</strong> or <strong>data/scored</strong> folder and use the name of the task/measure that it came from in the file name.</p>
<p>Set the <code>output_dir</code> and <code>output_file</code> in the setup section of the R script, and you should not need to modify this section at all.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/dr-jt\.github\.io\/r-for-psychology-students\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<script src="../site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.js" defer="true"></script>
</body></html>